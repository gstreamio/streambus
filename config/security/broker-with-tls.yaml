# StreamBus Broker Configuration with TLS/mTLS Security
# This example shows how to enable TLS encryption and mutual TLS authentication

broker_id: 1
host: "localhost"
port: 9092
grpc_port: 9093
http_port: 8080

data_dir: "./data/broker1"
raft_data_dir: "./data/raft1"

log_level: "info"

# Security Configuration
security:
  # TLS Configuration
  tls:
    enabled: true
    cert_file: "/path/to/certs/broker.crt"
    key_file: "/path/to/certs/broker.key"
    ca_file: "/path/to/certs/ca.crt"

    # Require client certificates (mTLS)
    require_client_cert: true
    verify_client_cert: true

    # Optional: Restrict allowed client certificate CNs
    allowed_client_cns:
      - "producer-service"
      - "consumer-service"
      - "admin-client"

    # Minimum TLS version (1.2 or 1.3)
    min_version: 1.2

  # SASL not enabled in this example (TLS-only)

  # Authorization
  authz_enabled: true

  # Super users (bypass all ACL checks)
  super_users:
    - "admin-client"

  # Allow anonymous access (not recommended for production)
  allow_anonymous: false

  # Audit logging
  audit_enabled: true
  audit_log_file: "/var/log/streambus/audit.log"

  # Use default ACLs
  use_default_acls: true

  # Encryption at rest
  encryption:
    enabled: true
    algorithm: "AES-256-GCM"
    master_key_path: "/path/to/keys/master.key"
    key_rotation_interval: "720h" # 30 days
    pbkdf2_iterations: 100000
