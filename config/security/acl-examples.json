{
  "description": "Example ACL configurations for StreamBus",
  "examples": [
    {
      "name": "Allow producer to write to specific topics",
      "acl": {
        "principal": "producer-service",
        "resource_type": "TOPIC",
        "resource_name": "orders",
        "pattern_type": "LITERAL",
        "action": "TOPIC_WRITE",
        "permission": "ALLOW"
      }
    },
    {
      "name": "Allow producer to write to all topics with prefix",
      "acl": {
        "principal": "producer-service",
        "resource_type": "TOPIC",
        "resource_name": "logs.",
        "pattern_type": "PREFIX",
        "action": "TOPIC_WRITE",
        "permission": "ALLOW"
      }
    },
    {
      "name": "Allow consumer to read from specific topic",
      "acl": {
        "principal": "consumer-service",
        "resource_type": "TOPIC",
        "resource_name": "orders",
        "pattern_type": "LITERAL",
        "action": "TOPIC_READ",
        "permission": "ALLOW"
      }
    },
    {
      "name": "Allow consumer group operations",
      "acl": {
        "principal": "consumer-service",
        "resource_type": "GROUP",
        "resource_name": "order-processors",
        "pattern_type": "LITERAL",
        "action": "GROUP_READ",
        "permission": "ALLOW"
      }
    },
    {
      "name": "Allow admin to create topics",
      "acl": {
        "principal": "admin-service",
        "resource_type": "TOPIC",
        "resource_name": "*",
        "pattern_type": "WILDCARD",
        "action": "TOPIC_CREATE",
        "permission": "ALLOW"
      }
    },
    {
      "name": "Allow admin to delete topics",
      "acl": {
        "principal": "admin-service",
        "resource_type": "TOPIC",
        "resource_name": "*",
        "pattern_type": "WILDCARD",
        "action": "TOPIC_DELETE",
        "permission": "ALLOW"
      }
    },
    {
      "name": "Allow admin cluster operations",
      "acl": {
        "principal": "admin-service",
        "resource_type": "CLUSTER",
        "resource_name": "cluster",
        "pattern_type": "LITERAL",
        "action": "CLUSTER_ACTION",
        "permission": "ALLOW"
      }
    },
    {
      "name": "Deny access to sensitive topic",
      "acl": {
        "principal": "public-consumer",
        "resource_type": "TOPIC",
        "resource_name": "sensitive-data",
        "pattern_type": "LITERAL",
        "action": "TOPIC_READ",
        "permission": "DENY"
      }
    },
    {
      "name": "Allow analytics service to read all topics",
      "acl": {
        "principal": "analytics-service",
        "resource_type": "TOPIC",
        "resource_name": "*",
        "pattern_type": "WILDCARD",
        "action": "TOPIC_READ",
        "permission": "ALLOW"
      }
    },
    {
      "name": "Allow transactional writes",
      "acl": {
        "principal": "transaction-coordinator",
        "resource_type": "TRANSACTION",
        "resource_name": "*",
        "pattern_type": "WILDCARD",
        "action": "TXN_WRITE",
        "permission": "ALLOW"
      }
    }
  ],

  "curl_examples": [
    {
      "description": "Create ACL via API",
      "command": "curl -X POST http://localhost:8080/api/v1/security/acls \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"principal\": \"producer-service\",\n    \"resource_type\": \"TOPIC\",\n    \"resource_name\": \"orders\",\n    \"pattern_type\": \"LITERAL\",\n    \"action\": \"TOPIC_WRITE\",\n    \"permission\": \"ALLOW\"\n  }'"
    },
    {
      "description": "List all ACLs",
      "command": "curl http://localhost:8080/api/v1/security/acls"
    },
    {
      "description": "Delete ACL",
      "command": "curl -X DELETE http://localhost:8080/api/v1/security/acls/{acl-id}"
    },
    {
      "description": "Check security status",
      "command": "curl http://localhost:8080/api/v1/security/status"
    },
    {
      "description": "Create user via API",
      "command": "curl -X POST http://localhost:8080/api/v1/security/users \\\n  -H 'Content-Type: application/json' \\\n  -d '{\n    \"username\": \"new-producer\",\n    \"password\": \"secure-password\",\n    \"auth_method\": \"SASL_SCRAM_SHA256\",\n    \"groups\": [\"producers\"]\n  }'"
    }
  ]
}
